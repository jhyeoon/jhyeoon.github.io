---
layout: post
title:  "ë°ì´í„°ë¹„ì¦ˆë‹ˆìŠ¤ 1ì£¼ì°¨"
date:   2024-09-15 00:00:01 +0800
categories: jekyll update
published: true
---

**#íŒŒì´ì¬ ë°ì´í„°ë¶„ì„ ì‹¤ë¬´ í…Œí¬ë‹‰ 100**

# 1ì¥ ì›¹ì—ì„œ ì£¼ë¬¸ ìˆ˜ë¥¼ ë¶„ì„í•˜ëŠ” í…Œí¬ë‹‰ 10

| no. | íŒŒì¼ ì´ë¦„ | ê°œìš” |
| --- | --- | --- |
| 1 | customer_master.csv | ê³ ê° ë°ì´í„° |
| 2 | item_master.csv | ì·¨ê¸‰í•˜ëŠ” ìƒí’ˆ ë°ì´í„° |
| 3-1 | transaction_1.csv | êµ¬ë§¤ë‚´ì—­ ë°ì´í„° |
| 3-2 | transaction_2.csv | 3-1ê³¼ ì—°ê²°ëœ ë¶„í•  ë°ì´í„° |
| 4-1 | transaction_detail_1.csv | êµ¬ë§¤ë‚´ì—­ ìƒì„¸ ë°ì´í„° |
| 4-2 | transaction_detail_2.csv | 4-1ê³¼ ì—°ê²°ëœ ë¶„í•  ë°ì´í„° |

## 1. ë°ì´í„° ì½ì–´ ë“¤ì´ê¸°

```python
import pandas as pd

customer_master = pd.read_csv('customer_master.csv')
item_master = pd.read_csv('item_master.csv')
transaction_1 = pd.read_csv('transaction_1.csv')
transaction_detail_1 = pd.read_csv('transaction_detail_1.csv')
```

customer_master

<img width="587" alt="image" src="https://github.com/user-attachments/assets/25453d03-034e-4b28-8edc-5fb3cc5c4ea6">


item_master

<img width="181" alt="image 1" src="https://github.com/user-attachments/assets/fa5341c4-d379-4391-bfc3-cb0f390aad4c">

transaction

<img width="301" alt="image 2" src="https://github.com/user-attachments/assets/e633fa86-6c2e-46a8-8f28-ce42f0afb817">

transaction_detail

<img width="233" alt="image 3" src="https://github.com/user-attachments/assets/7e420a26-a41d-43d0-b5f6-5db905cd3172">

## 2. ë°ì´í„° ê²°í•©(ìœ ë‹ˆì–¸)í•˜ê¸°

### ë°ì´í„° ê²°í•©

- ìœ ë‹ˆì–¸: í–‰ ë°©í–¥ìœ¼ë¡œ ì„¸ë¡œë¡œ ê²°í•©
- ì¡°ì¸: ì—´ ë°©í–¥ìœ¼ë¡œ ê°€ë¡œë¡œ ê²°í•©

```python
# transaction_1ê³¼ transaction_2 ìœ ë‹ˆì–¸
transaction_2 = pd.read_csv('transaction_2.csv')
transaction = pd.concat([transaction_1, transaction_2], ignore_index=True)

# transation_detail_1ê³¼ transaction_detail_2 ìœ ë‹ˆì–¸
transaction_detail_2 = pd.read_csv('transaction_detail_2.csv')
transaction_detail=pd.concat([transaction_detail_1,transaction_detail_2], ignore_index=True)

# transaction_1ê³¼ transaction_2 ìœ ë‹ˆì–¸ì´ ë˜ì—ˆëŠ”ì§€ í™•ì¸
print(len(transaction_1)) # 5000
print(len(transaction_2)) # 1786
print(len(transaction)) # 6786 = 5000 + 1786
```

`.concat()` : ë°ì´í„° ìœ ë‹ˆì–¸

`ignore_index=True` : ê¸°ì¡´ì˜ ì¸ë±ìŠ¤ ë¬´ì‹œ

|  | A | B |
| --- | --- | --- |
| 0 | 1 | 5 |
| 1 | 2 | 6 |
| 0 | 3 | 7 |
| 1 | 4 | 8 |

|  | A | B |
| --- | --- | --- |
| 0 | 1 | 5 |
| 1 | 2 | 6 |
| 2 | 3 | 7 |
| 3 | 4 | 8 |

## 3. ë°ì´í„° ê²°í•©(ì¡°ì¸)í•˜ê¸°

- ë°ì´í„°ë¥¼ ê°€ê³µí•  ë•ŒëŠ” ìƒì„¸í•˜ê²Œ ë‚˜ì™€ ìˆëŠ” ìª½ì— ë§ì¶”ì–´ ê°€ê³µ ì‹œì‘ (transaction_detail)
1. ë¶€ì¡±í•œ(ì¶”ê°€í•˜ê³  ì‹¶ì€) ë°ì´í„° ì¹¼ëŸ¼ì´ ë¬´ì—‡ì¸ê°€
2. ê³µí†µë˜ëŠ” ë°ì´í„° ì¹¼ëŸ¼ì€ ë¬´ì—‡ì¸ê°€

```python
# transaction_detailì— transactionì˜ payment_dateì™€ customer_id ì¶”ê°€
# transaction_idë¥¼ ê³µí†µ ì¹¼ëŸ¼ìœ¼ë¡œ
join_data = pd.merge(transaction_detail, transaction[["transaction_id", "payment_date", "customer_id"]], 
                     on="transaction_id", how="left")
```

`.merge()` : ë°ì´í„° ì¡°ì¸

`on=" "` : ê³µí†µ ì¹¼ëŸ¼ ì§€ì •

`how="left"` : ë ˆí”„íŠ¸ ì¡°ì¸

```python
# join_dataì— customer_master ì „ì²´ ì¶”ê°€
# customer_idë¥¼ ê³µí†µ ì¹¼ëŸ¼ìœ¼ë¡œ
join_data = pd.merge(join_data, customer_master, on="customer_id", how="left")

# join_dataì— item_master ì „ì²´ ì¶”ê°€
# item_idë¥¼ ê³µí†µ ì¹¼ëŸ¼ìœ¼ë¡œ
join_data = pd.merge(join_data, item_master, on="item_id", how="left")
```

## 4. í•„ìš”í•œ ë°ì´í„° ì¹¼ëŸ¼ ë§Œë“¤ê¸°

```python
# join_dataì˜ 'quantity'ì™€ 'item_price'ë¥¼ ê³±í•˜ì—¬ 'price' ì¹¼ëŸ¼ ì¶”ê°€í•˜ê¸°
join_data["price"] = join_data["quantity"] * join_data["item_price"]

# join_dataì—ì„œ ëª‡ ì¹¼ëŸ¼ë§Œ ë³´ì—¬ì£¼ê¸°
join_data[["quantity", "item_price","price"]].head()
```

`df[[" ", " "]].head()` : dfì—ì„œ ëª‡ ì¹¼ëŸ¼ë§Œ ë³´ì—¬ì£¼ê¸°

## 5. ë°ì´í„° ê²€ì‚°í•˜ê¸°

```python
# transactionì˜ priceì™€ join_dataì˜ priceê°€ ê°™ì€ì§€ í™•ì¸
print(join_data["price"].sum()) # 971135000
print(transaction["price"].sum()) # 971135000

join_data["price"].sum() == transaction["price"].sum() # True
```

## 6. í†µê³„ëŸ‰ íŒŒì•…í•˜ê¸°

```python
# ì¹¼ëŸ¼ë³„ ê²°ì¸¡ì¹˜ ê°œìˆ˜ í™•ì¸
join_data.isnull().sum()
```

`.isnull().sum()` 

: `.isnull()`ì€ ê²°ì†ì¹˜ë¥¼ True/Falseë¡œ ë°˜í™˜ 
â†’ `.sum()`í•˜ë©´ Trueì˜ ê°œìˆ˜ë¥¼ ì¹¼ëŸ¼ë§ˆë‹¤ í•©í•´ì¤Œ

<img width="125" alt="image 4" src="https://github.com/user-attachments/assets/934357a2-254a-4198-9d0e-2eb615e1ae3f">

```python
# ì¹¼ëŸ¼ë³„ í†µê³„ëŸ‰ í™•ì¸
join_data.describe()
```

`.descibe()`: ìˆ«ì ë°ì´í„°ë¥¼ ì§‘ê³„
- ë°ì´í„° ê°œìˆ˜(count), í‰ê· ê°’(mean), í‘œì¤€í¸ì°¨(std), ìµœì†Ÿê°’(min), ì‚¬ë¶„ìœ„ìˆ˜(25%, 75%), ì¤‘ì•™ê°’(50%), ìµœëŒ“ê°’(max) ì¶œë ¥

<img width="392" alt="image 5" src="https://github.com/user-attachments/assets/ae69ad93-d28f-4d20-a027-10d042b0d360">

```python
# ë°ì´í„°ì˜ ê¸°ê°„ í™•ì¸
print(join_data["payment_date"].min()) # 2019-02-01 01:36:57
print(join_data["payment_date"].max()) # 2019-07-31 23:41:38
```

## 7. ì›”ë³„ë¡œ ë°ì´í„° ì§‘ê³„í•˜ê¸°

```python
# payment_dateì˜ ë°ì´í„°í˜• í™•ì¸
join_data.dtypes

# payment_dateì˜ ë°ì´í„°í˜•ì„ objectì—ì„œ datetimeìœ¼ë¡œ ë°”ê¾¸ê¸°
join_data["payment_date"] = pd.to_datetime(join_data["payment_date"])

# payment_dataì—ì„œ ì—°, ì›”ë§Œ ì¶”ì¶œ
join_data["payment_month"] = join_data["payment_date"].dt.strftime("%Y%m")
```

`.dtypes` : ë°ì´í„°í˜• í™•ì¸

`to_datetime()` : ë°ì´í„°í˜•ì„ datetimeìœ¼ë¡œ ë³€í™˜
- datetimeìœ¼ë¡œ ë³€í™˜í•´ì•¼ .dt ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

`.dt.strfttime` : ë‚ ì§œì™€ ì‹œê°„ì„ ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¶”ê°€(string format time)

```python
# ì›”ë³„ ì´ íŒë§¤ì•¡ í•©ì‚°
join_data.groupby("payment_month").sum()["price"]
```

`.groupby()` : ê·¸ë£¹í™”

## 8. ì›”ë³„, ìƒí’ˆë³„ë¡œ ë°ì´í„° ì§‘ê³„í•˜ê¸°

```python
# ì›”ë³„ ìƒí’ˆë³„ ì´ íŒë§¤ì•¡, ìˆ˜ëŸ‰ í•©ì‚°
join_data.groupby(["payment_month","item_name"]).sum()[["price", "quantity"]]
```

<img width="167" alt="image 6" src="https://github.com/user-attachments/assets/40df63da-93e7-410b-a6d2-cac1877bede1">

```python
# í”¼ë²— í…Œì´ë¸”ë¡œ ë§Œë“¤ê¸°
pd.pivot_table(join_data, index='item_name', columns='payment_month', values=['price', 'quantity'], aggfunc='sum')
```

<img width="695" alt="image 7" src="https://github.com/user-attachments/assets/a12d232b-67ad-4402-9407-36e795edabe6">

`.pivot_table()` : í”¼ë²— í…Œì´ë¸” ìƒì„±

## 9. ë°ì´í„° ì‹œê°í™”í•˜ê¸°

```python
# ê·¸ë˜í”„ë¡œ ë§Œë“¤ ë°ì´í„° ê°€ê³µí•˜ê¸°
graph_data = pd.pivot_table(join_data, index='payment_month', columns='item_name', values='price', aggfunc='sum')
```

<img width="364" alt="image 8" src="https://github.com/user-attachments/assets/ae4384ac-b310-4c3c-8e1c-dc0824e49c86">

```python
# ìƒí’ˆë³„ ì‹œê°„(ì›”)ì— ë”°ë¥¸ íŒë§¤ì•¡ ê·¸ë˜í”„
import matplotlib.pyplot as plt
%matplotlib inline
plt.plot(list(graph_data.index), graph_data["PC-A"], label='PC-A')
plt.plot(list(graph_data.index), graph_data["PC-B"], label='PC-B')
plt.plot(list(graph_data.index), graph_data["PC-C"], label='PC-C')
plt.plot(list(graph_data.index), graph_data["PC-D"], label='PC-D')
plt.plot(list(graph_data.index), graph_data["PC-E"], label='PC-E')
plt.legend()  
```

<img width="284" alt="image 9" src="https://github.com/user-attachments/assets/d99bc601-152e-4e1b-b3fa-b3e5ee46ef4a">

`%matplotlib inline`: plt.show()ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•„ê³  ê·¸ë˜í”„ê°€ ìë™ìœ¼ë¡œ í‘œì‹œë¨

`.plot()` : ê°€ë¡œì¶•, ì„¸ë¡œì¶•ì˜ ìˆœì„œë¡œ ì§€ì •

`plt.legend()` : ë²”ë¡€ í‘œì‹œ

<aside>
ğŸ’¡

ì™œ graph_data.indexëŠ” listë¡œ ë§Œë“¤ì–´ì•¼ í•´?

- `graph_data.index`ëŠ” íŠ¹ìˆ˜í•œ pandasì˜ ****Index ****ê°ì²´
â†’ list()ë¡œ ë³€í™˜í•˜ì—¬ plot() í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë°”ê¿”ì•¼ í•¨
- `graph_data["PC-A"]`ëŠ” pandas Series ê°ì²´
â†’ ì´ë¯¸ plot()ì—ì„œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœì´ê¸° ë•Œë¬¸ì— ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜í•  í•„ìš”x
</aside>

# 2ì¥ ëŒ€ë¦¬ì  ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” í…Œí¬ë‹‰ 10

| no. | íŒŒì¼ ì´ë¦„ | ê°œìš” |
| --- | --- | --- |
| 1 | uriage.csv | ë§¤ì¶œ ì´ë ¥ (201901-201907) |
| 2 | kokyaku_daicho.xlsx | ê³ ê° ì •ë³´ |

## 1. ë°ì´í„° ì½ì–´ ë“¤ì´ê¸°

```python
import pandas as pd
uriage_data = pd.read_csv("uriage.csv")
kokyaku_data = pd.read_excel("kokyaku_daicho.xlsx")
```

uriage_data

<img width="206" alt="image" src="https://github.com/user-attachments/assets/4ed60d51-69a5-4f42-a264-35d4c3fc734b">

kokyaku_data

<img width="132" alt="image 1" src="https://github.com/user-attachments/assets/660c3aac-5741-4dc8-b2d3-248aa2e547d5">

## 2. ë°ì´í„° ì˜¤ë¥˜ ì‚´í”¼ê¸°

- ë°ì´í„°ì˜ ì •í•©ì„±: ì…ë ¥ ì˜¤ë¥˜ë‚˜ í‘œê¸° ë°©ë²•ì˜ ì°¨ì´ê°€ ë¶€ì •í•©ì„ ì¼ìœ¼í‚¤ë©´ ì •í•©ì„±ì— ë¬¸ì œê°€ ìˆëŠ” ê²ƒ

```python
uriage_data["item_name"].head()
uriage_data["item_price"].head()
kokyaku_data["ë“±ë¡ì¼"].head()
```

<img width="113" alt="image 2" src="https://github.com/user-attachments/assets/0e9417e8-22cd-447a-81a9-99248d0f803e">

<img width="119" alt="image 3" src="https://github.com/user-attachments/assets/de29859b-b938-4a79-86a1-97d0e3537010">

<img width="119" alt="image 4" src="https://github.com/user-attachments/assets/d7d3a738-a2b8-4d03-aec5-345ccc09bd1c">

## 3. ë°ì´í„° ì˜¤ë¥˜ê°€ ìˆëŠ” ìƒíƒœë¡œ ì§‘ê³„í•´ë³´ê¸°

```python
# purchase_dateì—ì„œ ì—°ì›” ì¶”ì¶œ
uriage_data["purchase_date"] = pd.to_datetime(uriage_data["purchase_date"])
uriage_data["purchase_month"] = uriage_data["purchase_date"].dt.strftime("%Y%m")

# ì›”ë³„ ìƒí’ˆë³„ ì´ ê±´ìˆ˜
res = uriage_data.pivot_table(index="purchase_month", columns="item_name", aggfunc="size", fill_value=0)
res
```

<img width="377" alt="image 5" src="https://github.com/user-attachments/assets/5d24fcc7-822e-46b2-ba31-382dd37758e4">

`.pivot_table()`

`aggfunc=` : **aggregation function**(ì§‘ê³„ í•¨ìˆ˜)ì„ ì§€ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜

`"size"`: í•´ë‹¹ ê·¸ë£¹ì— ìˆëŠ” í–‰ ìˆ˜ ë°˜í™˜

## 4. ìƒí’ˆëª… ì˜¤ë¥˜ ìˆ˜ì •í•˜ê¸°

```python
# ìƒí’ˆëª… ê°œìˆ˜ í™•ì¸
print(len(pd.unique(uriage_data["item_name"]))) # 99
```

â†’ ìƒí’ˆì˜ ì¢…ë¥˜ëŠ” ì›ë˜ 26ê°€ì§€ì¸ë° ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ìƒí’ˆëª…ì˜ ê°œìˆ˜ê°€ 99ê°œì„

`pd.unique()` : ì¤‘ë³µëœ ê°’ì„ ì œì™¸í•˜ê³  ìœ ì¼í•œ ê°’ë“¤ë§Œ ë°˜í™˜

### ëŒ€/ì†Œë¬¸ì í†µì¼ ë° ê³µë°± ì œê±°

```python
# ëŒ€ë¬¸ìë¡œ ë³€ê²½
uriage_data["item_name"] = uriage_data["item_name"].str.upper()

# ê³µë°± ì œê±°
uriage_data["item_name"] = uriage_data["item_name"].str.replace("ã€€", "")
uriage_data["item_name"] = uriage_data["item_name"].str.replace(" ", "")

# item_name ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ë°ì´í„° ì •ë ¬
uriage_data.sort_values(by=["item_name"], ascending=True)
```

`.sort_values()` : ë°ì´í„° ì •ë ¬

`by=[ ]` : ì–´ë–¤ ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í• ì§€ ì§€ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜

```python
# ìƒí’ˆëª… ë° ìƒí’ˆëª… ê°œìˆ˜ í™•ì¸ 
print(pd.unique(uriage_data["item_name"]))
print(len(pd.unique(uriage_data["item_name"]))) # 26
```

â†’ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ìƒí’ˆëª…ì´ ìƒí’ˆì˜ ì¢…ë¥˜ì™€ ì¼ì¹˜!

## 5. ê¸ˆì•¡ ê²°ì¸¡ì¹˜ ìˆ˜ì •í•˜ê¸°

```python
# ì¹¼ëŸ¼ë³„ ê²°ì¸¡ì¹˜ ìœ ë¬´ í™•ì¸
uriage_data.isnull().any(axis=0)
```

`.isnull()` : Trueë©´ ê²°ì¸¡ì¹˜ ì¡´ì¬

<aside>
ğŸ’¡

`.isnull()` vs `.isnull.any()` 

- ê° ì…€ì˜ ê²°ì¸¡ê°’ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì—¬ True/Falseì˜ DataFrame ë°˜í™˜
- ê° ì—´ì— í•˜ë‚˜ë¼ë„ ê²°ì¸¡ê°’ì´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì—¬ True/Falseì˜ Series ë°˜í™˜
</aside>

<img width="87" alt="image 6" src="https://github.com/user-attachments/assets/47c8882e-4a08-4e72-a8eb-c06709a70b3f">

### ê²°ì¸¡ì¹˜ë¥¼ ê°™ì€ ìƒí’ˆ ë‚´ ìµœëŒ€ ê°€ê²©ìœ¼ë¡œ ëŒ€ì²´

```python
# item_priceê°€ nullì¸ í–‰ ì¶”ì¶œ
flg_is_null = uriage_data["item_price"].isnull()

# ê²°ì¸¡ì¹˜ë¥¼ ê°™ì€ ìƒí’ˆ ë‚´ ìµœëŒ€ ê°€ê²©ìœ¼ë¡œ ëŒ€ì²´
# flg_is_nullì´ Trueì¸ í–‰ì˜ item_name ì—´ ì¶”ì¶œí•˜ì—¬ ë¦¬ìŠ¤íŠ¸ë¡œ
for trg in list(uriage_data.loc[flg_is_null, "item_name"].unique()): 
        # price -> flg_is_nullì´ Falseì´ë©° item_nameì´ trgì¸ item_priceê°’ì˜ ìµœëŒ“ê°’
    price = uriage_data.loc[(~flg_is_null) & (uriage_data["item_name"] == trg), "item_price"].max()
    # flg_is_nullì´ Trueì´ë©° item_nameì´ trgì¸ item_price -> price
    uriage_data["item_price"].loc[(flg_is_null) & (uriage_data["item_name"]==trg)] = price
```

```python
# ì¹¼ëŸ¼ë³„ ê²°ì¸¡ì¹˜ ìœ ë¬´ í™•ì¸
uriage_data.isnull().any(axis=0)
```

<img width="91" alt="image 7" src="https://github.com/user-attachments/assets/4318620e-9a22-474a-a518-5453b7e7767f">

```python
# ì¤‘ë³µë˜ì§€ ì•ŠëŠ” item_nameì„ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ë¦¬ìŠ¤íŠ¸ë¡œ
for trg in list(uriage_data["item_name"].sort_values().unique()):
        # íŠ¹ì • item_nameì˜ ìµœê³ ê°€ì™€ ìµœì €ê°€ ì¶œë ¥
    print(trg + "ì˜ìµœê³ ê°€ï¼š" + str(uriage_data.loc[uriage_data["item_name"]==trg]["item_price"].max()) 
          + "ì˜ìµœì €ê°€ï¼š" + str(uriage_data.loc[uriage_data["item_name"]==trg]["item_price"].min(skipna=False)))
```

â†’ ëª¨ë“  ìƒí’ˆëª…ì— ëŒ€í•œ ìµœê³ ê°€ = ìµœì €ê°€

â†’ ê²°ì¸¡ì¹˜ê°€ ì˜ ì²˜ë¦¬ë¨!

`.min()` 

`skipna=False` : NaNì´ ì¡´ì¬í•  ê²½ìš° ìµœì†Ÿê°’ì´ NaNìœ¼ë¡œ í‘œì‹œë¨

## 6. ê³ ê° ì´ë¦„ ì˜¤ë¥˜ ìˆ˜ì •í•˜ê¸°

```python
# kokyaku_dataì—ì„œì˜ ê³ ê° ì´ë¦„
kokyaku_data["ê³ ê°ì´ë¦„"].head()
```

<img width="125" alt="image 8" src="https://github.com/user-attachments/assets/a982d08e-1ba0-4580-892a-381148296ac0">

```python
# uriage_dataì—ì„œì˜ ê³ ê° ì´ë¦„
uriage_data["customer_name"].head()
```

<img width="123" alt="image 9" src="https://github.com/user-attachments/assets/93f0abb5-b189-4c14-a6bd-9d249568823d">

```python
# kokyaku_dataì˜ ê³ ê° ì´ë¦„ì—ì„œ ê³µë°± ì œê±°
kokyaku_data["ê³ ê°ì´ë¦„"] = kokyaku_data["ê³ ê°ì´ë¦„"].str.replace("ã€€", "")
kokyaku_data["ê³ ê°ì´ë¦„"] = kokyaku_data["ê³ ê°ì´ë¦„"].str.replace(" ", "")
```

## 7. ë‚ ì§œ ì˜¤ë¥˜ ìˆ˜ì •í•˜ê¸°

```python
kokyaku_data["ë“±ë¡ì¼"]
```

<img width="149" alt="image 10" src="https://github.com/user-attachments/assets/baee7ad8-3b48-4525-bd01-12844a7ace5f">

```python
# ìˆ«ìë¡œë§Œ ì´ë£¨ì–´ì§„ ì˜¤ë¥˜ ë°ì´í„° ì¶”ì¶œ
flg_is_serial = kokyaku_data["ë“±ë¡ì¼"].astype("str").str.isdigit()

# ìˆ«ìë¡œë§Œ ì´ë£¨ì–´ì§„ ì˜¤ë¥˜ ë°ì´í„° ê°œìˆ˜ í™•ì¸
flg_is_serial.sum() # 22
```

`.astype()` : íŠ¹ì • ë°ì´í„°í˜•ìœ¼ë¡œ ë³€í™˜

`.str.isdigit()` : ê° ê°’ì´ ìˆ«ìë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©´ True, ì•„ë‹ˆë©´ False ë°˜í™˜

```python
# ì˜¤ë¥˜ ë°ì´í„°ì˜ ë“±ë¡ì¼ì˜ ë°ì´í„°í˜•ì„ floatë¡œ ë³€í™˜
# ë‹¨ìœ„ëŠ” ì¼(Day)
# ê¸°ì¤€ ë‚ ì§œë¡œë¶€í„° ì˜¤ë¥˜ ë°ì´í„° ì¼ìˆ˜ë§Œí¼ì„ ë”í•˜ì—¬ ì‹¤ì œ ë‚ ì§œ êµ¬í•˜ê¸°
fromSerial = pd.to_timedelta(kokyaku_data.loc[flg_is_serial, "ë“±ë¡ì¼"].astype("float"), unit="D") + pd.to_datetime("1900/01/01")
```

`.to_timedelta()` : ì‹œê°„ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” timedelta ê°ì²´ë¡œ ë³€í™˜

`unit="D"` : ë‹¨ìœ„ê°€ ì¼(Day)

`.to_datetime("1900/01/01")`: 1900/01/01ì¼ì„ datetime ê°ì²´ë¡œ ë³€í™˜

```python
# ì˜¤ë¥˜ê°€ ì•„ë‹Œ ë°ì´í„°ì˜ ë“±ë¡ì¼ì˜ ë°ì´í„°í˜•ì„ datetimeìœ¼ë¡œ ë³€í™˜
fromString = pd.to_datetime(kokyaku_data.loc[~flg_is_serial, "ë“±ë¡ì¼"])

# ìˆ˜ì •í•œ ì˜¤ë¥˜ ë°ì´í„°ì™€ ì˜¤ë¥˜ê°€ ì•„ë‹Œ ë°ì´í„° í•©í•˜ê¸°
kokyaku_data["ë“±ë¡ì¼"] = pd.concat([fromSerial, fromString])
```

## 8. ë‘ ê°œì˜ ë°ì´í„° ê²°í•©(ì¡°ì¸)í•˜ê¸°

### ê³ ê° ì´ë¦„ì„ í‚¤ë¡œ ë‘ ê°œì˜ ë°ì´í„° ì¡°ì¸

```python
# uriage_dataì˜ customer_nameê³¼ kokyaku_dataì˜ ê³ ê° ì´ë¦„ì„ í‚¤ë¡œ ë°ì´í„° ë ˆí”„íŠ¸ ì¡°ì¸
join_data = pd.merge(uriage_data, kokyaku_data, left_on="customer_name", right_on="ê³ ê°ì´ë¦„", how="left")
# uriage_dataì˜ customer_name ì¹¼ëŸ¼ì€ ì‚­ì œ
join_data = join_data.drop("customer_name", axis=1)
```

## 9. ì •ì œí•œ ë°ì´í„° ë¤í”„í•˜ê¸°

```python
# ë°ì´í„° ì¹¼ëŸ¼ ì •ë ¬í•˜ê¸°
dump_data = join_data[["purchase_date", "purchase_month", "item_name", "item_price", "ê³ ê°ì´ë¦„", "ì§€ì—­", "ë“±ë¡ì¼"]]

# ë°ì´í„° ë¤í”„í•˜ê¸°
dump_data.to_csv("dump_data.csv", index=False)
```

## 10. ë°ì´í„° ì§‘ê³„í•˜ê¸°

```python
# ì›”ë³„ ìƒí’ˆë³„ íŒë§¤ ê°œìˆ˜
byItem = import_data.pivot_table(index="purchase_month", columns="item_name", aggfunc="size", fill_value=0)

# ì›”ë³„ ìƒí’ˆë³„ ì´ íŒë§¤ì•¡
byPrice = import_data.pivot_table(index="purchase_month", columns="item_name", values="item_price", aggfunc="sum", fill_value=0)
```

<img width="443" alt="image 11" src="https://github.com/user-attachments/assets/61b8651f-bbc6-4bcf-a3c1-e0f9b0874abc">

<img width="452" alt="image 12" src="https://github.com/user-attachments/assets/148e0a9f-fec0-48bd-99fe-05c39dd03ea3">

```python
# êµ¬ë§¤ì´ë ¥ì´ ì—†ëŠ” ì‚¬ìš©ì í™•ì¸
away_data = pd.merge(uriage_data, kokyaku_data, left_on="customer_name", right_on="ê³ ê°ì´ë¦„", how="right")
away_data[away_data["purchase_date"].isnull()][["ê³ ê°ì´ë¦„", "ë“±ë¡ì¼"]]
```

**#í†µê³„101 ë°ì´í„°ë¶„ì„**

# 1ì¥. í†µê³„í•™ì´ë€?

### ë°ì´í„° ë¶„ì„ì˜ ëª©ì 

1. ë°ì´í„° ìš”ì•½
2. ë°ì´í„° ì„¤ëª…
    1. ì¸ê³¼ê´€ê³„
    2. ìƒê´€ê´€ê³„
3. ë°ì´í„° ì˜ˆì¸¡
    - ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ ì°¨ì´(ì˜¤ì°¨)ê°€ ì‘ì€ ê´€ê³„ì„±

### í†µê³„í•™ì˜ ì—­í• 

: ë°ì´í„°ì˜ ì‚°í¬ë‚˜ ë¶ˆí™•ì‹¤ì„±ì— ëŒ€ì²˜ 

- í™•ë¥ ë¡ : ì‚°í¬ë‚˜ ë¶ˆí™•ì‹¤ì„±ì„ í™•ë¥ ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê²ƒ

### í†µê³„í•™

1. ê¸°ìˆ í†µê³„: ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  ìš”ì•½í•˜ëŠ” ë°©ë²•
2. ì¶”ë¡ í†µê³„: ìˆ˜ì§‘í•œ ë°ì´í„°ë¡œë¶€í„° ë°ì´í„°ì˜ ë°œìƒì›ì„ ì¶”ì •í•˜ëŠ” ë°©ë²•
    1. í†µê³„ì  ì¶”ë¡ : ë°ì´í„°ì—ì„œ ê°€ì •í•œ í™•ë¥  ëª¨í˜•ì˜ ì„±ì§ˆì„ ì¶”ì •í•˜ëŠ” ë°©ë²•
    2. ê°€ì„¤ê²€ì •: ì„¸ìš´ ê°€ì„¤ê³¼ ì–»ì€ ë°ì´í„°ê°€ ì–¼ë§ˆë‚˜ ë“¤ì–´ë§ëŠ”ì§€ë¥¼ í‰ê°€í•˜ì—¬, ê°€ì„¤ì„ ì±„íƒí•  ê²ƒì¸ê°€ë¥¼ íŒë‹¨í•˜ëŠ” ë°©ë²•

# 2ì¥. ëª¨ì§‘ë‹¨ê³¼ í‘œë³¸

### ëª¨ì§‘ë‹¨

: ì•Œê³ ì í•˜ëŠ” ëŒ€ìƒ ì „ì²´

### ëª¨ì§‘ë‹¨ì˜ í¬ê¸°

: ëª¨ì§‘ë‹¨ì— í¬í•¨ëœ ìš”ì†Œì˜ ìˆ˜

1. ìœ í•œëª¨ì§‘ë‹¨: ëª¨ì§‘ë‹¨ ì¤‘ í•œì •ëœ ìš”ì†Œë§Œ í¬í•¨í•œ ê²ƒ
2. ë¬´í•œëª¨ì§‘ë‹¨: ëª¨ì§‘ë‹¨ ì¤‘ í¬í•¨ëœ ìš”ì†Œì˜ ê°œìˆ˜ê°€ ë¬´í•œí•œ ê²ƒ

### ëª¨ì§‘ë‹¨ì˜ ì„±ì§ˆ

1. ì „ìˆ˜ì¡°ì‚¬: ëª¨ì§‘ë‹¨ì— í¬í•¨ëœ ëª¨ë“  ìš”ì†Œë¥¼ ì¡°ì‚¬í•˜ëŠ” ê¸°ìˆ í†µê³„
2. í‘œë³¸ì¡°ì‚¬: ëª¨ì§‘ë‹¨ì˜ ì¼ë¶€ë¥¼ ë¶„ì„í•˜ì—¬ ëª¨ì§‘ë‹¨ ì „ì²´ì˜ ì„±ì§ˆì„ ì¶”ì •í•˜ëŠ” ì¶”ë¡ í†µê³„

# 3ì¥. í†µê³„ë¶„ì„ì˜ ê¸°ì´ˆ

### ë³€ìˆ˜

: ê³µí†µì˜ ì¸¡ì • ë°©ë²•ìœ¼ë¡œ ì–»ì€ ê°™ì€ ì„±ì§ˆì˜ ê°’

- ì°¨ì›
: ë³€ìˆ˜ì˜ ê°œìˆ˜
1. ì–‘ì  ë³€ìˆ˜ (ìˆ˜ì¹˜í˜• ë³€ìˆ˜)
: ìˆ«ìë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” ë³€ìˆ˜
    1. ì´ì‚°í˜• ì–‘ì  ë³€ìˆ˜ (ì´ì‚° ë³€ìˆ˜)
    2. ì—°ì†í˜• ì–‘ì  ë³€ìˆ˜ (ì—°ì†ë³€ìˆ˜)
2. ì§ˆì  ë³€ìˆ˜ (ë²”ì£¼í˜• ë³€ìˆ˜)
: ë²”ì£¼ë¡œ ë³€ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë³€ìˆ˜

### ë„ìˆ˜ë¶„í¬ë„ (íˆìŠ¤í† ê·¸ë¨)

1. ì´ì‚°í˜• ì–‘ì  ë³€ìˆ˜ì˜ íˆìŠ¤í† ê·¸ë¨
2. ì—°ì†í˜• ì–‘ì  ë³€ìˆ˜ì˜ íˆìŠ¤í† ê·¸ë¨
    1. êµ¬ê°„í­
    : ë²”ìœ„ì˜ ë„“ì´
3. ë²”ì£¼í˜• ë³€ìˆ˜ì˜ íˆìŠ¤í† ê·¸ë¨

### í†µê³„ëŸ‰

1. ê¸°ìˆ í†µê³„ëŸ‰ (ìš”ì•½í†µê³„ëŸ‰)
: ë°ì´í„° ê·¸ ìì²´ì˜ ì„±ì§ˆì„ ê¸°ìˆ í•˜ê³  ìš”ì•½í•˜ëŠ” í†µê³„ëŸ‰
    1. ëŒ€í‘¯ê°’
        1. í‰ê· ê°’
        2. ì¤‘ì•™ê°’
        3. ìµœë¹ˆê°’
    2. ì‚°í¬
        1. ë¶„ì‚°
        $í‘œë³¸ë¶„ì‚° s^2=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\bar{x})^2$
        2. í‘œì¤€í¸ì°¨ (s)

### ìƒì ìˆ˜ì—¼ ê·¸ë¦¼

<img width="404" alt="image" src="https://github.com/user-attachments/assets/99c4cda8-9cc8-4706-ab91-73888c80434c">

### ì—¬ëŸ¬ ê°€ì§€ ì‹œê°í™” ê·¸ë¦¼

<img width="407" alt="image 1" src="https://github.com/user-attachments/assets/b5ab6ff1-2426-4401-888e-687f652ca00c">

### í™•ë¥ 

- í™•ë¥ ë³€ìˆ˜
ex) P(X=í° êµ¬ìŠ¬)=1/5ì—ì„œ â€˜Xâ€™
- ì‹¤í˜„ê°’
ex) P(X=í° êµ¬ìŠ¬)=1/5ì—ì„œ â€˜í° êµ¬ìŠ¬â€™

### í™•ë¥  ë¶„í¬

: ê°€ë¡œì¶•ì— í™•ë¥ ë³€ìˆ˜, ì„¸ë¡œì¶•ì— ê·¸ í™•ë¥ ë³€ìˆ˜ì˜ ë°œìƒ ê°€ëŠ¥ì„±ì„ í‘œì‹œí•œ ë¶„í¬

- ì´ì‚°í˜• í™•ë¥ ë¶„í¬
- ì—°ì†í˜• í™•ë¥ ë¶„í¬
    - í™•ë¥ ë°€ë„í•¨ìˆ˜
        
        <img width="401" alt="image 2" src="https://github.com/user-attachments/assets/b2839a78-895c-49eb-bad3-597324af2074">
        
- ê¸°ëŒ“ê°’ E(X)
    - ì´ì‚°í˜•
    $E(X)=\sum_{i=1}^{k}P(X=x_{i})$
    - ì—°ì†í˜•
    $E(X)=\int xf(x)dx$
- ë¶„ì‚°
    - ì´ì‚°í˜•
    $V(X)=\sum_{i=1}^{k}(x_{i}-E(X))^2P(X=x_{i})$
    - ì—°ì†í˜•
    $V(X)=\int(x-E(X))^2f(x))dx$
- ì™œë„
: ì¢Œìš° ëŒ€ì¹­ì—ì„œ ì–´ëŠ ì •ë„ ë²—ì–´ë‚¬ëŠ”ì§€
- ì²¨ë„
: ë¶„í¬ê°€ ì–¼ë§ˆë‚˜ ë¾°ì¡±í•œì§€, ê·¸ë˜í”„ì˜ ê¼¬ë¦¬ê°€ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨ì´ ì–¼ë§ˆì¸ì§€
- ë™ì‹œ í™•ë¥ ë¶„í¬ P(X, Y)
    - ë…ë¦½
    P(X, Y)=P(X)*P(Y)
    - ì¡°ê±´ë¶€í™•ë¥ 
    P(X|Y)

### íŒŒë¼ë¯¸í„° (ëª¨ìˆ˜)

: ë¶„í¬ì˜ í˜•íƒœë¥¼ ì •í•˜ëŠ” ìˆ«ì

### ì •ê·œë¶„í¬ (ê°€ìš°ìŠ¤ ë¶„í¬)

$N(\mu, \sigma^2)$

$f(x)=\frac{1}{\sqrt{2\pi\sigma^2}}exp(-\frac{(x-\mu)^2}{2\sigma^2})$

<img width="201" alt="image 3" src="https://github.com/user-attachments/assets/932cf263-e040-4cad-9d8f-f2ae6d36ef52">

### í‘œì¤€ì •ê·œë¶„í¬

$N(0, 1)$

- í‘œì¤€í™”
$z=\frac{x-\mu}{\sigma}$